package com.example.assignmenttracker;

import java.util.Calendar;
import java.util.Date;
import java.util.HashMap;

import android.app.Activity;
import android.content.Intent;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuItem;

public class EmailContentToSendActivity extends Activity {

	private String assTitle, emailTo, emailSubject, emailMsg, courseTitle,
			assProgress;
	private int assDueDate;
	private int daysTillDue;
	SQLiteDatabase db = MainActivity.db.getReadableDatabase();

	@Override
	protected void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);
		setContentView(R.layout.activity_email_content_to_send);
		Intent getEmailDestInfoIntent = getIntent();
		assTitle = getEmailDestInfoIntent.getStringExtra("assTitle");
		emailTo = getEmailDestInfoIntent.getStringExtra("emailTo");
		emailSubject = getEmailDestInfoIntent.getStringExtra("emailSubject");
		emailMsg = getEmailDestInfoIntent.getStringExtra("emailMsg");

		Cursor c;
		if (MainActivity.role == "Student") {
			c = db.query(
					"tbl_Assignment",
					new String[] { "assignmentNo, assignmentTitle, assignmentCourse, assignmentDueDate, assignmentProgress" },
					"assignmentTitle = \"" + assTitle + "\";", null, null,
					null, null);
		} else { // role == "Teacher"
			c = db.query(
					"tbl_TeacherAssignment",
					new String[] { "assignmentNo, assignmentTitle, assignmentCourse, assignmentDueDate, assignmentProgress" },
					"assignmentTitle = \"" + assTitle + "\";", null, null,
					null, null);
		}

		while (c.moveToNext()) {
			assTitle = c.getString(0) + ": " + assTitle;
			courseTitle = c.getString(2);
			assProgress = c.getString(4);
			assDueDate = new Date(c.getString(3));
			int today = Integer.parseInt((new Date()).toString()); 
			daysTillDue = assDueDate - today;
			
		}

	}

	@Override
	public boolean onCreateOptionsMenu(Menu menu) {
		// Inflate the menu; this adds items to the action bar if it is present.
		getMenuInflater().inflate(R.menu.email_content_to_send, menu);
		return true;
	}

	@Override
	public boolean onOptionsItemSelected(MenuItem item) {
		// Handle action bar item clicks here. The action bar will
		// automatically handle clicks on the Home/Up button, so long
		// as you specify a parent activity in AndroidManifest.xml.
		int id = item.getItemId();
		if (id == R.id.action_settings) {
			return true;
		}
		return super.onOptionsItemSelected(item);
	}
}
